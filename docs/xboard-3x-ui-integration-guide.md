# Xboard 与 3x-ui 对接教程

## 1. 环境准备

### 1.1 系统要求
- 推荐使用 Ubuntu 20.04 或更高版本
- 最小配置：2核4G内存
- 建议配置：4核8G内存
- 系统盘建议50GB以上

### 1.2 安装Docker
```bash
# 安装Docker
curl -fsSL https://get.docker.com | bash

# 启动Docker服务
systemctl enable docker
systemctl start docker
```

## 2. Xboard安装配置

### 2.1 快速部署
```bash
# 下载安装脚本
wget -O install.sh https://raw.githubusercontent.com/cedar2025/Xboard/main/install.sh

# 执行安装
bash install.sh
```

### 2.2 基础配置
1. 访问管理面板：`http://服务器IP:7001`
2. 使用安装时生成的管理员账号登录
3. 完成以下基础配置：
   - 站点信息设置
   - 管理员密码修改
   - 支付接口配置（可选）
   - 邮件服务配置（推荐）

## 3. 3x-ui节点配置

### 3.1 安装3x-ui
```bash
# 下载安装脚本
bash <(curl -Ls https://raw.githubusercontent.com/cedar2025/3x-ui/main/install.sh)
```

### 3.2 开启API访问
1. 登录3x-ui面板
2. 进入面板设置
3. 配置以下选项：
   - 启用gRPC API
   - 设置API密钥（请记录此密钥）
   - 配置允许访问的IP（填写Xboard服务器IP）

## 4. 节点对接配置

### 4.1 添加节点服务器
1. 在Xboard管理面板中进入`节点管理`
2. 点击`添加节点`
3. 填写节点信息：
   - 节点名称：自定义
   - 节点类型：选择`3x-ui`
   - 节点地址：填写3x-ui服务器IP或域名
   - API密钥：填写之前设置的3x-ui API密钥
   - 节点分组：选择或新建分组

### 4.2 节点测试与启用
1. 点击`测试连接`确认节点可以正常通信
2. 确认无误后点击`启用节点`
3. 配置节点的具体参数：
   - 流量倍率
   - 用户限速
   - 节点标签
   - 排序权重

## 5. 用户管理与同步

### 5.1 用户数据同步
- Xboard会自动同步用户数据到3x-ui节点
- 同步内容包括：
  - 用户账号信息
  - 流量限制
  - 到期时间
  - 订阅配置

### 5.2 流量统计
- 3x-ui节点会实时统计用户流量使用情况
- 数据会自动同步到Xboard面板
- 可在管理面板查看：
  - 实时流量统计
  - 历史使用记录
  - 节点负载情况

## 6. 性能优化建议

### 6.1 系统优化
1. 调整系统参数
```bash
# 编辑系统配置
vi /etc/sysctl.conf

# 添加以下配置
net.ipv4.tcp_fastopen = 3
net.ipv4.tcp_max_tw_buckets = 1000000
net.ipv4.tcp_max_syn_backlog = 819200
```

2. 优化内核参数
```bash
# 应用配置
sysctl -p
```

### 6.2 节点优化
1. 合理设置节点参数
   - 避免过高的流量倍率
   - 根据服务器配置设置合适的用户限速
   - 控制单节点用户数量

2. 启用节点负载均衡
   - 配置多个后端节点
   - 设置合理的权重
   - 启用故障转移

## 7. 故障排查

### 7.1 连接问题
1. 检查网络连通性
```bash
# 测试端口连通性
telnet 节点IP 节点端口

# 检查防火墙规则
iptables -L
```

2. 检查API配置
- 确认API密钥正确
- 检查IP白名单设置
- 查看3x-ui日志

### 7.2 同步问题
1. 检查Xboard日志
```bash
# 查看同步日志
docker logs xboard-web
```

2. 检查3x-ui状态
```bash
# 查看3x-ui状态
x-ui status

# 查看详细日志
journalctl -u x-ui
```

## 8. 安全建议

1. 更改默认端口
   - 修改面板访问端口
   - 使用随机的服务端口

2. 启用安全设置
   - 开启面板登录验证码
   - 配置登录失败限制
   - 定期更新面板密码

3. 防火墙配置
```bash
# 仅开放必要端口
ufw allow 节点端口
ufw allow 面板端口
```

## 9. 常见问题

1. 节点无法连接
   - 检查服务器防火墙设置
   - 确认API密钥配置正确
   - 验证节点服务是否正常运行

2. 流量统计不准确
   - 检查时间同步设置
   - 确认节点计费设置
   - 查看同步任务状态

3. 用户无法使用服务
   - 检查用户账号状态
   - 确认流量是否超限
   - 验证订阅是否过期

## 10. 维护建议

1. 定期维护
   - 检查系统资源使用情况
   - 清理日志文件
   - 更新面板版本

2. 数据备份
   - 定期备份配置文件
   - 备份用户数据
   - 保存重要的系统日志

3. 监控告警
   - 配置资源使用告警
   - 设置节点状态监控
   - 启用异常流量提醒

## 11. 技术支持

- 项目地址：https://github.com/cedar2025/Xboard
- 问题反馈：通过GitHub Issues
- 功能建议：通过GitHub Discussions
- 安全漏洞：请通过私密渠道报告